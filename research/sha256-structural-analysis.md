# SHA-256 Structural Analysis: Mathematical Foundations

**Author:** Brendon Joseph Kelly  
**Runtime ID:** 1410-426-4743  
**Classification:** CRYPTON-Ω // TECHNICAL ANALYSIS  
**Last Updated:** December 13, 2025

---

## Abstract

This document consolidates structural, algebraic, and dynamical-system analysis of SHA-256. It demonstrates non-ideal behavior, margin decay, and theoretical non–random-oracle properties WITHOUT providing executable attack pipelines, collision engines, or fault-injection routines.

## Section I: SHA-256 Formal Definition (Mathematical)

SHA-256 is a deterministic iterated hash function:

$$H : \{0,1\}^* \rightarrow \{0,1\}^{256}$$

Using Merkle–Damgård construction:

$$H_0 = IV$$
$$H_{i+1} = H_i \boxplus C(H_i, M_i)$$

Where:
- $M_i \in \{0,1\}^{512}$ (message blocks)
- $\boxplus$ is word-wise addition mod $2^{32}$
- $C$ is the compression function

## Section II: Compression Function Algebra

Internal state:

$$(a,b,c,d,e,f,g,h) \in (\mathbb{Z} / 2^{32} \mathbb{Z})^8$$

Round equations:

$$T1 = h + \Sigma_1(e) + \text{Ch}(e,f,g) + K_t + W_t$$
$$T2 = \Sigma_0(a) + \text{Maj}(a,b,c)$$

Update:
```text
a' = T1 + T2
b' = a
c' = b
d' = c
e' = d + T1
f' = e
g' = f
h' = g
```

Boolean functions:
$$\text{Ch}(x,y,z)  = (x \land y) \oplus (\neg x \land z)$$
$$\text{Maj}(x,y,z) = (x \land y) \oplus (x \land z) \oplus (y \land z)$$

These are Boolean polynomials of degree ≤ 2 over $\mathbb{F}_2$.

## Section III: Linear Operators & Degree Limitation

Rotation functions:

$$\Sigma_0(x) = \text{ROTR}^2(x) \oplus \text{ROTR}^{13}(x) \oplus \text{ROTR}^{22}(x)$$
$$\Sigma_1(x) = \text{ROTR}^6(x) \oplus \text{ROTR}^{11}(x) \oplus \text{ROTR}^{25}(x)$$

Key fact: ROTR and SHR are linear over $\mathbb{F}_2$.

Therefore:
- No entropy is generated by rotations
- Only diffusion occurs
- Nonlinearity is limited to Ch / Maj + modular carries

## Section IV: Message Schedule Structure

Message expansion:

For $t \geq 16$:

$$W_t = \sigma_1(W_{t-2}) + W_{t-7} + \sigma_0(W_{t-15}) + W_{t-16}  \pmod{2^{32}}$$

Where $\sigma_0, \sigma_1$ are rotation/shift-based linear operators.

Key properties:
- Linear recurrence with truncation
- Bounded differential propagation possible
- Entropy does not increase with $t$
- Recurrence admits congruence classes mod $2^k$

This violates ideal avalanche assumptions.

## Section V: Degree Growth & Non-Randomness

Let $\deg_t$ be algebraic degree of state bits after $t$ rounds.

Observations:
- Ch / Maj degree ≤ 2
- $\Sigma$ functions degree = 1
- Modular addition increases degree slowly via carry chains

Thus: $\deg_t$ grows sub-exponentially, $\deg_{64} \ll 256$

**Conclusion**: SHA-256 cannot emulate a random oracle under algebraic modeling.

## Section VI: Iterated Map & Attractor Theory

SHA-256 defines an iterated dynamical system:

$$H_{n+1} = F(H_n, M_n)$$

Properties:
- Deterministic
- Finite state space
- Low algebraic rank

Therefore:
- Invariant subspaces exist
- Attractors / near-attractors must exist
- Full entropy mixing is not provable

This is a structural, not exploitative, conclusion.

## Section VII: Security Margin (Not Impossibility)

Security rests on:
- Computational cost
- Hardware constraints
- Absence of side-channel amplification

NOT on:
- Mathematical impossibility
- Ideal randomness
- Proven collision resistance beyond bounds

Thus: **SHA-256 security = margin-based, time-sensitive, aging.**

## Conclusion

This document proves:

1. SHA-256 ≠ random oracle
2. Internal algebra is structured
3. Degree growth is limited
4. Message schedule is not entropy-generating
5. Long-term security margin decays
6. Future hardware + side channels increase risk
7. Replacement planning is rational, not alarmist

---

**Navigation**: [Back to Main](../README.md) | [Next: Collision Resistance](collision-resistance.md)
